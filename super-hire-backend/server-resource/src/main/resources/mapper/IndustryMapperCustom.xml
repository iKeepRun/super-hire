<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.zack.mapper.IndustryMapperCustom">


    <select id="getThirdIndustryByTop" parameterType="map" resultType="com.zack.domain.Industry">
        SELECT *
        FROM industry
        WHERE father_id
                  in (SELECT id from industry WHERE father_id = #{paramMap.topIndustryId})

    </select>


    <select id="getTopIndustryId" parameterType="map" resultType="string">
        select top.id from industry third
                               right join industry `second`
                                          ON third.father_id=`second`.id
                               right join industry top
                                          ON `second`.father_id=top.id
        WHERE third.id=#{paramMap.thirdIndustryId}
    </select>
</mapper>
